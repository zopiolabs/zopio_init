// This file contains intentional XSS vulnerabilities for testing CodeQL
const express = require('express');
const app = express();

// BAD: Direct HTML injection - XSS vulnerability
app.get('/search', (req, res) => {
  const searchTerm = req.query.q;
  // Vulnerable to XSS - no sanitization
  const html = `
    <html>
      <body>
        <h1>Search Results</h1>
        <p>You searched for: ${searchTerm}</p>
      </body>
    </html>
  `;
  res.send(html);
});

// BAD: Unsafe innerHTML usage
app.get('/profile', (req, res) => {
  const userBio = req.query.bio;
  // Vulnerable to XSS
  res.send(`
    <script>
      document.getElementById('bio').innerHTML = '${userBio}';
    </script>
  `);
});

// BAD: Reflected XSS in error messages
app.get('/error', (req, res) => {
  const errorMsg = req.query.msg;
  // Vulnerable to XSS
  res.status(400).send(`<h1>Error: ${errorMsg}</h1>`);
});

// BAD: DOM-based XSS
app.get('/redirect', (req, res) => {
  const url = req.query.url;
  // Vulnerable to XSS
  res.send(`
    <script>
      window.location.href = '${url}';
    </script>
  `);
});